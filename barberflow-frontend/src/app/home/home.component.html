<div class="container">
  
  <header class="top-bar">
    <div class="brand">
      <img src="assets/logo.jpg" onerror="this.src='assets/logo.png'" alt="Logo" class="logo-img">
      <h1 class="brand-name">BarberFlow</h1>
    </div>
    
    <div class="user-actions">
      <div class="greeting-container">
        <span class="welcome-text">Ol√°, <strong>{{ usuarioNome }}</strong></span>
        
        <button class="btn-logout" (click)="logout()" title="Sair">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16 17 21 12 16 7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
          </svg>
        </button>
      </div>
      
      <button *ngIf="isBarber" (click)="irParaAgendaBarbeiro()" class="btn-outline">
        Minha Agenda
      </button>
    </div>
  </header>

  <div *ngIf="isLoading" class="loading-overlay">
    <div class="spinner"></div>
    <span class="loading-text">Sincronizando...</span>
  </div>

  <div class="card agendado-card" *ngIf="!isLoading && meuAgendamentoAtual">
    <div class="check-icon">‚úÖ</div>
    <h2 class="form-title">Tudo Pronto!</h2>
    <p class="subtitle">Seu hor√°rio est√° confirmado.</p>

    <div class="info-group">
      <div class="info-row">
        <span>üìÖ Dia:</span>
        <strong>{{ meuAgendamentoAtual.date_time | date:'dd/MM/yyyy' }}</strong>
      </div>
      <div class="info-row">
        <span>‚è∞ Hora:</span>
        <strong>{{ meuAgendamentoAtual.date_time | date:'HH:mm' }}</strong>
      </div>
      <div class="info-row">
        <span>‚úÇÔ∏è Servi√ßo:</span>
        <strong>{{ meuAgendamentoAtual.service_name }}</strong>
      </div>
      <div class="info-row">
        <span>üíà Profissional:</span>
        <strong>{{ meuAgendamentoAtual.barber_name }}</strong>
      </div>
    </div>

    <button class="btn-cancel" (click)="cancelarAgendamento()">Cancelar Agendamento</button>
  </div>

  <div class="card" *ngIf="!isLoading && !meuAgendamentoAtual">
    <h2 class="form-title">‚úÇÔ∏è Novo Agendamento</h2>

    <p *ngIf="barbeiros.length === 0" style="color: red; text-align: center; font-size: 0.9rem;">
      Nenhum profissional dispon√≠vel no momento.
    </p>

    <div *ngIf="barbeiros.length > 0">
      <label>1. Profissional:</label>
      <select [(ngModel)]="agendamento.barber_id" (change)="atualizarHorariosDisponiveis()">
        <option value="" disabled selected>Selecione...</option>
        <option *ngFor="let b of barbeiros" [value]="b.id">{{ b.name }}</option>
      </select>

      <label>2. Servi√ßo:</label>
      <select [(ngModel)]="agendamento.service_id">
        <option value="" disabled selected>Selecione...</option>
        <option *ngFor="let s of servicos" [value]="s.id">
          {{ s.name }} ‚Äî {{ s.price | currency:'BRL' }}
        </option>
      </select>

      <div class="row">
        <div class="col">
          <label>3. Data:</label>
          <input type="date" [(ngModel)]="agendamento.data" [min]="minDate" (change)="atualizarHorariosDisponiveis()">
        </div>
        <div class="col">
          <label>4. Hor√°rio:</label>
          <select [(ngModel)]="agendamento.hora">
            <option value="" disabled selected>--:--</option>
            <option *ngFor="let h of horariosFiltrados" [value]="h">{{ h }}</option>
            <option *ngIf="horariosFiltrados.length === 0" disabled>Lotado!</option>
          </select>
        </div>
      </div>

      <button class="btn-primary" (click)="confirmarAgendamento()">
        Confirmar Agendamento
      </button>
    </div>
  </div>
</div>